# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Parallel a single EM iteration.
#'
#' Add zero at the head of input \code{spenum}.
#'
#' @title Single EM iteration
#' @return A updated \code{arma::vec} of count percentage.
#' @param countper A \code{arma::vec} of input count percentage.
#' @param efflen A \code{std::vector<arma::vec>} indicated the effective length of transcripts.
#' @param ec A \code{std::vector<arma::vec>} indicated equivalence classes with the same length of \code{efflen}.
#' @param ecnum A \code{arma::uvec} indicated the mapped count number of equivalence class with the same length of \code{efflen}.
#' @param spenum A \code{arma::uvec} indicated number of transcripts.
#' @author Yulong Niu \email{yulong.niu@@hotmail.com}
#' @keywords internal
EMSingle <- function(countper, efflen, ec, ecnum, spenum) {
    .Call(`_RNASeqEM_EMSingle`, countper, efflen, ec, ecnum, spenum)
}

#' Split strings and equivalence classes.
#'
#' \itemize{
#'   \item \code{Strsplit()}: Split a \code{string} with an user-defined delimiter.
#'   \item \code{SplitEC()}: Split batch of equivalence classes in \code{string} format.
#' }
#'
#' @title Preprocess equivalence classes.
#' @return
#' \itemize{
#'   \item \code{Strsplit()}: A \code{arma::uvec} indicating the corresponding transcripts ID (starts from 0).
#'   \item \code{SplitEC}: A \code{std::vector<arma::uvec>} and each element indicates the transcripts IDs.
#' }
#' @param s A \code{string}.
#' @param delim The delimiter
#' @references \href{https://ysonggit.github.io/coding/2014/12/16/split-a-string-using-c.html}{split string in C++}
#' @author Yulong Niu \email{yulong.niu@@hotmail.com}
#' @rdname strsplit
#' @keywords internal
Strsplit <- function(s, delim) {
    .Call(`_RNASeqEM_Strsplit`, s, delim)
}

#' @param ec A \code{character vector} and each element is a string with comma delimiter.
#' @rdname strsplit
#' @keywords internal
SplitEC <- function(ec) {
    .Call(`_RNASeqEM_SplitEC`, ec)
}

#' Match transcript effect length with equivalence classes.
#'
#' The length of \code{efflen} is equal to number of transcripts.
#'
#' @title Match transcript effect length
#' @return A \code{std::vector<arma::vec>} with the same length of \code{ecvec}.
#' @param ecvec A \code{std::vector<arma::uvec>} containing separated vectors, such as the output of \code{SplitEC()} in this package.
#' @param efflen A code{arma::vec} indicating the effect length of transcript.
#' @author Yulong Niu \email{yulong.niu@@hotmail.com}
#' @keywords internal
MatchEfflen <- function(ecvec, efflen) {
    .Call(`_RNASeqEM_MatchEfflen`, ecvec, efflen)
}

#' Index transcripts number of input species.
#'
#' Add zero at the head of input \code{spenum}.
#'
#' @title Index species number
#' @return A \code{arma::uvec}.
#' @param spenum A \code{arma::uvec} indicated the transcript number in each species.
#' @author Yulong Niu \email{yulong.niu@@hotmail.com}
#' @keywords internal
IdxSpenum <- function(spenum) {
    .Call(`_RNASeqEM_IdxSpenum`, spenum)
}

