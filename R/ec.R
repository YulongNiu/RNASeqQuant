##' Read in equivalence class
##'
##' Read in equivalence class file generated from \code{kallisto} (version 0.44.0). The \code{*.ec} file can be generated by the \code{pseudo} command in the \code{kallisto}.
##'
##' @title Standard read in ec files
##' @param ecpath The path of ec files.
##' @return A \code{list} each element is combined transcript IDs
##' @examples
##' require('magrittr')
##'
##' ec <- system.file('extdata', 'example.ec', package = 'RNASeqEM') %>% read_ec
##' @author Yulong Niu \email{yulong.niu@@hotmail.com}
##' @importFrom readr read_tsv
##' @importFrom dplyr select
##' @export
##'
read_ec <- function(ecpath) {

  ecMat <- ecpath %>%
    read_tsv(col_names = c('ec', 't'))

  ecList <- ecMat %>%
    select(t) %>%
    unlist %>%
    strsplit(',', fixed = TRUE)

  names(ecList) <- ecMat %>%
    select(ec) %>%
    unlist

  return(ecList)
}
